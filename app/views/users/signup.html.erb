<% redIfConn if check_conn %>
<% if params.has_key?("nickname") && params.has_key?("email") && params.has_key?("password") %>
<% params["email"] = params["email"].gsub(/\s+/, "") %>
<% params["nickname"] = params["nickname"].gsub(/\s+/, "") %>
  <% if params["nickname"].length > 2 && params["nickname"].length < 16 %>
    <% if params["password"].length > 7 && params["password"].length < 43 %>
      <% if params["email"].length > 3 && params["email"].length < 100 %>
        <% res = signup(params) %>
        <% if res == 'OK' %>
          <% @errors = "Benvenuto!" %>
        <% else %>
          <% @errors = res %>
        <% end %>
      <% else %>
        <% @errors = "Email non valida" %>
      <% end %>
    <% else %>
      <% @errors = "La password deve avere minimo 8 e massimo 42 caratteri" %>
    <% end %>
  <% else %>
    <% @errors = "Il nickname deve avere minimo 3 e massimo 15 caratteri" %>
  <% end %>
<% else %>
  <% @errors = "Riempi tutti i campi" %>
<% end %>

<%= render "layouts/header" %>
